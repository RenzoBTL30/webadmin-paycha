<div class="space-y-2">
  <div class="grid grid-cols-2 gap-2 sm:gap-4">
    <div class="col-span-2 md:col-span-1">
      <h2 class="text-lg sm:text-2xl font-bold">Pedidos Completados</h2>
    </div>

 
    
  </div>
  <div class="row" style="padding: 20px;">
    <div class="col-4">
      <input
      class="form-control"
      type="search"
      placeholder="Buscar pedido por código"
      aria-label="Search"
      [(ngModel)]="searchedString"
    />
    </div>
    <div class="col-3" >
      <input type="text" placeholder="dd/mm/yyyy - dd/mm/yyyy" class="form-control" bsDaterangepicker
      [bsValue]="date" 
       [bsConfig]="{ isAnimated: true, showWeekNumbers: false }"  (bsValueChange)="onValueChange($event)"
       />
    </div>
    <div class="col-2">
      <button class="btn btn-icon" (click)="getOrdenesCompletadas()"><i class="fa-solid fa-magnifying-glass"></i></button>
    </div>
  </div>
  <div *ngIf="isLoading" class="box-spinner">
    <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
  <div class="table-responsive mt-4" *ngIf="ordenesCompletadas.totalElements > 0">
    <table class="table">
      <thead>
        <tr>
          <th scope="col">N°</th>
          <th scope="col">Código</th>
          <th scope="col">Cliente</th>
          <th scope="col">Fecha y Hora</th>
          <th scope="col">Tiempo estimado <hr style="border: 0;"> de entrega</th>
          <th scope="col">Detalle</th>
          <th scope="col">Total</th>
        </tr>
      </thead>
      <tbody>
          <tr
          *ngFor="
            let o of ordenesCompletadas.content | search: 'codigo':searchedString; 
            let i = index
          "
          >
            <td>{{ i + 1 }}</td>
            <td>{{ o.codigo }}</td>
            <td>{{ o.cliente.nombre }} {{o.cliente.apellidos}}</td>
            <td>{{ formatearFecha(o.fecha_orden)}}</td>
            <td>{{ o.tiempo_entrega == null ? '-' : o.tiempo_entrega}}</td>
            <td style="text-align: center; color: #0d6efd;">
              <span class="material-icons-outlined icon-detalle" 
              data-bs-toggle="modal" 
              data-bs-target="#detallePedido"
              (click)="detallePedido(o)"
              >visibility</span>
            </td>
            <td>S/ {{ o.total | number:'1.2-2'}}</td>
          </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="ordenesCompletadas.totalElements == 0; else pagination" class="pb-4">
    <div class="blankDiv">No hay Registros Disponibles</div>
  </div>
  <ng-template #pagination>
    <div class="d-flex justify-content-end">
      <ngb-pagination [(page)]="page"
      [pageSize]="ordenesCompletadas.size"
      [collectionSize]="ordenesCompletadas.totalElements"   (pageChange)="getOrdenesCompletadas()"></ngb-pagination>
    </div>
</ng-template>
  <div></div>
</div>



<app-detalle-orden [orden]="orden"></app-detalle-orden>